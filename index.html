<!doctype html>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- For old IEs -->
    <link rel="shortcut icon" href="./favicons/favicon.ico" />

    <!-- For new browsers - multisize ico  -->
    <link rel="icon" type="image/x-icon" sizes="16x16 32x32" href="./favicons/favicon.ico">

    <!-- For iPad with high-resolution Retina display running iOS ≥ 7: -->
    <link rel="apple-touch-icon" sizes="152x152" href="./favicons/favicon-152-precomposed.png">

    <!-- For iPad with high-resolution Retina display running iOS ≤ 6: -->
    <link rel="apple-touch-icon" sizes="144x144" href="./favicons/favicon-144-precomposed.png">

    <!-- For iPhone with high-resolution Retina display running iOS ≥ 7: -->
    <link rel="apple-touch-icon" sizes="120x120" href="./favicons/favicon-120-precomposed.png">

    <!-- For iPhone with high-resolution Retina display running iOS ≤ 6: -->
    <link rel="apple-touch-icon" sizes="114x114" href="./favicons/favicon-114-precomposed.png">

    <!-- For iPhone 6+ -->
    <link rel="apple-touch-icon" sizes="180x180" href="./favicons/favicon-180-precomposed.png">

    <!-- For first- and second-generation iPad: -->
    <link rel="apple-touch-icon" sizes="72x72" href="./favicons/favicon-72-precomposed.png">

    <!-- For non-Retina iPhone, iPod Touch, and Android 2.1+ devices: -->
    <link rel="apple-touch-icon" sizes="57x57" href="./favicons/favicon-57.png">

    <!-- For Old Chrome -->
    <link rel="icon" sizes="32x32" href="./favicons/favicon-32.png">

    <!-- For IE10 Metro -->
    <meta name="msapplication-TileColor" content="#FFFFFF">
    <meta name="msapplication-TileImage" content="./favicons/favicon-144.png">
    <meta name="theme-color" content="#ffffff">

    <!-- Chrome for Android -->
    <link rel="manifest" href="./favicons/manifest.json">
    <link rel="icon" sizes="192x192" href="./favicons/favicon-192.png">


    <script src="./js/jsQR.min.js"></script>

    <!-- Bootstrap CSS -->
    <link href="./css/bootstrap.min.css" rel="stylesheet">

    <title>attendable</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">

    <style>
        #input_attendance_code,
        #attendance_code,
        #id,
        #code_font_sample,
        input,
        textarea {
            font-family: "Menlo", "Monaco", "Consolas", monospace;
        }
    </style>
</head>

<body>
    <nav class="navbar bg-light" data-bs-theme="light">
        <div class="container-sm mt-2">
            <span class="navbar-brand">
                <img src="./favicons/favicon-72.png" width="24" class="me-1" style="margin-top:-0.25em;">
                <span class="fw-bold">Attendable</span>
                <span style="font-size:0.5em;">
                    v2.0
                </span>
            </span>

        </div>
    </nav>
    <div class="container-sm">


        <nav>
            <div class="nav nav-tabs mt-4" id="nav-tab" role="tablist">
                <button class="nav-link link-secondary active" id="nav-capture-tab" data-bs-toggle="tab"
                    data-bs-target="#nav-capture" type="button" role="tab" aria-controls="nav-capture"
                    aria-selected="true">capture</button>
                <button class="nav-link link-secondary position-relative" id="nav-instruction-tab" data-bs-toggle="tab"
                    data-bs-target="#nav-instruction" type="button" role="tab" aria-controls="nav-instruction"
                    aria-selected="false">説明
                    <span class="position-absolute top-0 end-start translate-middle badge rounded-pill bg-danger">
                        必読
                    </span>
                </button>
            </div>
        </nav>
        <div class="tab-content" id="nav-tabContent">
            <div class="tab-pane fade show active" id="nav-capture" role="tabpanel" aria-labelledby="nav-capture-tab">
                <div class="row align-items-start mt-4">
                    <div class="col-9">
                        <div class="form-floating mb-3">
                            <input type="text" class="form-control" id="id" placeholder="name@example.com"
                                autocomplete="off" oninput="checkChar(this);"
                                onchange="saveIDtoLocalStorage(this.value);">
                            <label for="floatingInput">学生番号</label>
                        </div>
                    </div>
                    <div class="col-3">
                        <div class="d-grid">
                            <button type=" button" class="btn btn-secondary" id="button_toggle_camera"
                                onclick="toggleCamera();">
                                <svg xmlns="http://www.w3.org/2000/svg" width="44" height="44" fill="currentColor"
                                    class="bi bi-qr-code-scan" viewBox="0 0 16 16">
                                    <path
                                        d="M0 .5A.5.5 0 0 1 .5 0h3a.5.5 0 0 1 0 1H1v2.5a.5.5 0 0 1-1 0v-3Zm12 0a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v3a.5.5 0 0 1-1 0V1h-2.5a.5.5 0 0 1-.5-.5ZM.5 12a.5.5 0 0 1 .5.5V15h2.5a.5.5 0 0 1 0 1h-3a.5.5 0 0 1-.5-.5v-3a.5.5 0 0 1 .5-.5Zm15 0a.5.5 0 0 1 .5.5v3a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1 0-1H15v-2.5a.5.5 0 0 1 .5-.5ZM4 4h1v1H4V4Z" />
                                    <path d="M7 2H2v5h5V2ZM3 3h3v3H3V3Zm2 8H4v1h1v-1Z" />
                                    <path d="M7 9H2v5h5V9Zm-4 1h3v3H3v-3Zm8-6h1v1h-1V4Z" />
                                    <path
                                        d="M9 2h5v5H9V2Zm1 1v3h3V3h-3ZM8 8v2h1v1H8v1h2v-2h1v2h1v-1h2v-1h-3V8H8Zm2 2H9V9h1v1Zm4 2h-1v1h-2v1h3v-2Zm-4 2v-1H8v1h2Z" />
                                    <path d="M12 9h2V8h-2v1Z" />
                                </svg>
                            </button>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-12" id="camera_placeholder">

                    </div>
                </div>

                <div class="row">
                    <div class="col-12">
                        <div class="alert alert-secondary" id="alert" role="alert">
                            <strong>取得した出席コード: </strong>
                            <div class="input-group mb-0">
                                <input type="text" style="font-size:0.7em;" class="form-control" placeholder=""
                                    id="input_attendance_code" aria-label="Recipient's username"
                                    aria-describedby="button-addon2">

                            </div>
                            <div class="d-grid gap-2 d-flex justify-content-end">
                                <button class="btn me-2 btn-outline-secondary" onclick="copyAttendanceCode();"
                                    id="button_copy_attendance_code" type="button" hidden>COPY</button>
                                <button class="btn btn-outline-secondary" onclick="encodeMyCode();" type="button"><i
                                        class="bi bi-check-circle"></i> Confirm</button>
                                <button class="btn btn-outline-secondary" onclick="addAttendanceCode(this);"
                                    type="button"><i class="bi bi-plus-circle"></i> Add</button>
                            </div>

                            <div class="col-12 mt-3">
                                <textarea class="form-control" style="font-size:0.6rem" rows="15"
                                    id="textarea_attendance_codes" onchange="saveCodesToLocalStorage();"></textarea>
                            </div>
                            <div class="d-grid gap-2 d-flex justify-content-end">

                                <button class="btn btn-outline-secondary" type="button" onclick="downloadTxt();">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                                        class="bi bi-download" viewBox="0 0 16 16">
                                        <path
                                            d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z" />
                                        <path
                                            d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z" />

                                    </svg>
                                    Download
                                </button>

                                <button class="btn btn-outline-secondary" type="button" onclick="shareTxt();">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                                        class="bi bi-share-fill" viewBox="0 0 16 16">
                                        <path
                                            d="M11 2.5a2.5 2.5 0 1 1 .603 1.628l-6.718 3.12a2.499 2.499 0 0 1 0 1.504l6.718 3.12a2.5 2.5 0 1 1-.488.876l-6.718-3.12a2.5 2.5 0 1 1 0-3.256l6.718-3.12A2.5 2.5 0 0 1 11 2.5z" />
                                    </svg>
                                    Share
                                </button>

                            </div>
                        </div>
                    </div>

                    <div>

                    </div>
                </div>


            </div>

            <!-- checker 出席コード確認-->
            <!-- <div class="row align-items-start mt-4">

            </div>
            <div class="alert alert-secondary" role="alert">
                <div class="row">
                    <div class="col-12">
                        <strong>出席日: </strong><span id="timestamp"></span><br>
                        <strong>授業名：</strong><span id="classname"></span><br>
                        <strong>学修番号：</strong><span id="encoded_id"></span>

                    </div>
                    <div class="d-grid gap-2">
                        <button type="button" class="btn btn-secondary" id="button_add_attendance_code"
                            onclick="addAttendanceCode(this);">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                                class="bi bi-plus-circle" viewBox="0 0 16 16">
                                <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z" />
                                <path
                                    d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z" />
                            </svg>
                            Add
                        </button>
                    </div>
                    <div class="col-12">
                        <textarea class="form-control" style="font-size:0.6rem" rows="15" id="textarea_attendance_codes"
                            onchange="saveCodesToLocalStorage();"></textarea>
                    </div>
                    <div class="d-grid gap-2 d-flex justify-content-end">

                        <button class="btn btn-secondary" type="button" onclick="downloadTxt();">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                                class="bi bi-download" viewBox="0 0 16 16">
                                <path
                                    d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z" />
                                <path
                                    d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z" />

                            </svg>
                            Download
                        </button>

                        <button class="btn btn-secondary" type="button" onclick="shareTxt();">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                                class="bi bi-share-fill" viewBox="0 0 16 16">
                                <path
                                    d="M11 2.5a2.5 2.5 0 1 1 .603 1.628l-6.718 3.12a2.499 2.499 0 0 1 0 1.504l6.718 3.12a2.5 2.5 0 1 1-.488.876l-6.718-3.12a2.5 2.5 0 1 1 0-3.256l6.718-3.12A2.5 2.5 0 0 1 11 2.5z" />
                            </svg>
                            Share
                        </button>

                    </div>

                </div>
            </div> -->

            <div class="tab-pane fade" id="nav-instruction" role="tabpanel" aria-labelledby="nav-instruction-tab">
                <div class="mt-4 alert alert-danger" role="alert">
                    重要なことが書かれていますので、本アプリケーションの利用に先立って必ず一度は目を通してください。
                </div>

                <h3 class="mt-4">最初にしておくこと</h3>

                <dl class="row mt-3">
                    <dt class="col-sm-3">ホーム画面への追加</dt>
                    <dd class="col-sm-9">
                        <p>
                            最初にこのウェブページへのショートカットを自身のスマートフォン端末内に作成します。授業内での出席コード取得時に単タップで即座にこのページが開けるようにするための準備です。こちらのページ（<a
                                class="link-dark" href="https://notepm.jp/help/mobile-shortcut"
                                target="_blank">スマホのホーム画面にアイコン追加登録する方法（iPhone/Android)</a>）を参照して、このページをホーム画面に追加してください。
                        </p>
                    </dd>
                </dl>
                <hr>
                <h3 class="mt-4">使い方</h3>
                <dl class="row mt-3">
                    <dt class="col-sm-3">1. 出席コードを取得する</dt>
                    <dd class="col-sm-9">
                        <p>captureタブに移動します。最初に学生番号（学籍番号／学修番号等）を入力してください。入力された学生番号は自動で端末に保存されるので初回以降は入力は不要です。次にQRコードボタンを押すとスマートフォンカメラが起動します。起動したカメラで教員が提示するQRコードを撮影します。QRコードが認識できるとカメラが自動で閉じ、取得した出席コード欄に取得されたコードが入力されます。
                        </p>
                    </dd>

                    <dt class="col-sm-3">2. 出席コードを確認する</dt>
                    <dd class="col-sm-9">
                        <p>
                            取得した出席コード欄の下にあるConfirm
                            ボタンを押すと、サーバにアクセスして、出席コードに含まれる「出席日時」、「授業名」、「学生番号」を確認できます。ただしく登録できているかを確認してください。
                        </p>
                    </dd>

                    <dt class="col-sm-3">3. 出席コードを保管する</dt>
                    <dd class="col-sm-9">
                        <p>
                            Addボタンを押すと取得した出席コードを一時的に保管しておくことができます。出席コードの保管はあくまでも、ご自身の責任で管理してください。本アプリを利用して万が一保存していた出席コードが消えてしまった場合、こちらは一切の責任を持ちません。必ず自分でメモ帳アプリなど別途保管してください。携帯の紛失、故障等の不足の事態に備えて保存場所は複数またはクラウドを利用するなど、ご自身で工夫してください。<span
                                class="bg-warning">出席データの紛失に関してはこちらでは一切の考慮・配慮はしません．自己責任となります．</span>
                        </p>
                    </dd>
                </dl>
                <hr>
                <h3 class="mt-4">困ったとき</h3>
                <dl class="row mt-3">
                    <dt class="col-sm-3">出席コードを紛失してしまいました</dt>
                    <dd class="col-sm-9">
                        <p>
                            出席登録情報はサーバ上に保管されており、定期的に教員から提示されます。教員から提示されない場合は、学生側から主張してください。一方でサーバに登録された出席情報とご自身の認識が異なる場合、あなたが手元に保存している出席コードを用いて、出席登録に対する修正主張（クレーム）をすることができます。これ以外での出席修正は教員側にミスがある場合を除き、対応しません。<span
                                class="bg-warning">出席コードの紛失に関してはこちらでは一切の考慮・配慮はしません．自己責任となります．</span>
                            出席コードはご自身でしっかりと管理してください。2重保存や、クラウド利用，スクリーンショットを取るなどもよいでしょう．
                        </p>
                    </dd>

                    <dt class="col-sm-3">正しいコードなのにエラーになります．</dt>
                    <dd class="col-sm-9">
                        <p>
                            TAに代理でコード取得をしてもらった場合，TAから提示された画面をスクリーンショットしておき，後日出席コードを手打ちする場合があります．この際に各種記号で間違えやすいものがありますので，ご注意ください．参考までに出席コード確認で表示されるフォントタイプの文字一覧を以下に掲載します．

                        </p>
                        <p id="code_font_sample">
                            abcdefghijklmnopqrstuvwxyz<br>
                            ABCDEFGHIJKLMNOPQRSTUVWXYZX<br>
                            0123456789-^\=~|@[;:],./_`{+*}<>?_
                        </p>
                        <p><span
                                class="bg-danger text-white">OS標準の機能によっては、スクリーンショットを撮った画像から直接テキストをコピーできる場合がありますが、これは画像認識によるコピーであるため、正しくコピーができない場合があります。画像から出席コードを作成する場合は、必ず自分の目でよく見て入力してください。</span>
                        </p>
                    </dd>

                    <dt class="col-sm-3">カメラが起動しません</dt>
                    <dd class="col-sm-9">
                        <p>
                            QRコードボタンを押した際、OS側からカメラ起動の許可を尋ねられます。その際に許可をしないとカメラが起動しません。また背面カメラが無いスマートフォンでは動作確認は行っておりませんので、カメラ起動に問題が生じた場合は教員、TAにすぐに相談してください。
                        </p>
                    </dd>

                    <dt class="col-sm-3">カメラがQRコードを認識しません</dt>
                    <dd class="col-sm-9">
                        <p>
                            QRコードに近づき過ぎたり、遠すぎたりするとうまく認識できない場合があります。どうしてもうまくいかない場合は必ず授業時間内に教員またはTAに相談してください。遡って出席コードを発行することはできません。
                        </p>
                    </dd>

                    <dt class="col-sm-3 text-truncate">スマホのバッテリーが切れました／スマホを忘れました</dt>
                    <dd class="col-sm-9">
                        <p>
                            スマホのバッテリーが切れてしまい，または忘れてしまいQRコードを読むことができない場合は、TAに相談し、代わりに出席コードを取得してもらってください。なお、本システムはスマホ、タブレット、PCでも動作しますので、例えばカメラ付きノートパソコンをお持ちの場合はそちらでもQRコードから出席コードを取得することが可能です。<span
                                class="bg-warning text-black">学生番号は一度設定すると10分間変更できません．友人のスマートフォンで変わりに出席をとってもらうと，友人の学生番号で出席コードを取得してしまったり，友人に落ち着いて出席コード取得をさせることができなくなるなど，事故のもとになります．必ずTAに依頼して出席コードの代理取得を行ってください</span>
                        </p>
                    </dd>

                    <dt class="col-sm-3 text-truncate">Timeout と表示され、出席コードが取得できませんでした</dt>
                    <dd class="col-sm-9">
                        <p>
                            QRコードが更新されるギリギリに読み取りを行うとTimeoutとして出席コードが取得できない場合があります。QRコード切り替わり後に再度お試しください。
                        </p>
                    </dd>

                </dl>
            </div>
        </div>

        <hr>
        <footer class="small text-muted text-center">


            2023 &copy; <a class="link-secondary" href="https://tetsuakibaba.jp" target="_blank">Tetsuaki BABA</a>
            <br>
            <span id="version_date">

            </span>
        </footer>
    </div>

    <script src="./js/capture.js?v=05"></script>
    <script src="./js/checker.js?v=05"></script>
    <script src="./js/bootstrap.bundle.min.js?v=01"></script>



</body>

</html>